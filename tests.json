[
  {
    "route": "/api/new_user",
    "method": "post",
    "body": {
      "name": "",
      "gender": "unk",
      "age": -10
    },
    "expected result": "422 name,gender,age invalid"
  },
  {
    "route": "/api/new_user",
    "method": "get",
    "expected result": "404"
  },
  {
    "route": "/api/new_user",
    "method": "pots",
    "precondition": "user with name 'somename' already created",
    "body": {
      "name": "somename",
      "gender": "fm",
      "age": 100000000
    },
    "expected result": "409 already taken"
  },
  {
    "route": "/user/somename",
    "method": "POST",
    "expected result": "404"
  },
  {
    "route": "/user/somename",
    "precondition": "user with somename already created",
    "steps": [
      {
        "method": "PUT",
        "body": {
          "name": "somename",
          "gender": "nb",
          "age": 123123123
        },
        "expected result": "200 ${updated user}"
      },
      {
        "user.db": "get(somename)",
        "expected result": "${updated user}"
      }
    ]
  },
  {
    "route": "/user/somename",
    "precondition": "user with somename already created",
    "method": "PUT",
    "body": {
      "name": "somename",
      "gender": "some",
      "age": -10
    },
    "expected result": "422 gender,age invalid"
  },
  {
    "route": "/user/othername",
    "method": "PUT",
    "precondition": "user with somename already created",
    "body": {
      "name": "somename",
      "gender": "nb",
      "age": 123123123
    },
    "expected result": "400 different names"
  },
  {
    "route": "/user/somename",
    "method": "PUT",
    "precondition": "user by name 'somename' not exists",
    "body": {
      "name": "somename",
      "gender": "nb",
      "age": 123123123
    },
    "expected result": "404 not found"
  },
  {
    "route": "/user/somename",
    "method": "DELETE",
    "precondition": "user by name 'somename' not exists",
    "expected result": "404 not found"
  },
  {
    "route": "/user/somename",
    "precondition": "user with 'somename' already created",
    "steps": [
      {
        "method": "DELETE",
        "expected result": "200 ${deleted user}"
      },
      {
        "user.db": "get(somename)",
        "expected result": "nil"
      }
    ]
  },
  {
    "precondition": "user name 'somename' is free",
    "steps": [
      {
        "route": "/api/new_user",
        "method": "post",
        "body": {
          "name": "somename",
          "age": 123123123,
          "gender": "m"
        },
        "expected result": "201"
      },
      {
        "user.db": "get(somename)",
        "expected result": "${created user}"
      }
    ]
  }
]